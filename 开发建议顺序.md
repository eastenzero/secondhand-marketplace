# 开发建议顺序（MVP）

与 Backlog（B1–B10）一致，推荐后端/数据库优先、前端并行，两周一迭代。

## 阶段0｜环境与骨架（0.5d）
- 目标：可运行的单体骨架与本地开发环境。
- 任务：项目结构（backend/database/frontend）、.env.example、日志/错误处理中间件、lint/格式化、健康检查。
- 验收：健康检查200；lint无误；基础日志输出。

## 阶段1｜数据库初始化（B1，2d）
- 任务：执行 database/db-schema.sql，接入迁移工具（Flyway/Knex），最小种子数据。
- 验收：迁移/回滚通过；核心索引生效。

## 阶段2｜认证模块（B2，3d）
- 任务：POST /api/register、/api/login；JWT HttpOnly Cookie；鉴权中间件；用户Repo。
- 验收：TC-REG-001、TC-AUTH-002 通过；401/403 正确返回。

## 阶段3｜商品发布与详情（B3，3d）
- 任务：POST /api/items、GET /api/items/{id}；状态 draft→active（默认不审核）。
- 验收：TC-ITEM-003、TC-DETAIL-005 通过；审计落表。

## 阶段4｜商品搜索（B4，2d）
- 任务：GET /api/items?keywords&filters&page&size；分页与必要索引；缓存预留。
- 验收：TC-SEARCH-004；P95≤800ms（小样本）。

## 阶段5｜需求模块对称实现（B5，3d）
- 任务：POST/GET /api/demands、详情；与商品对称。
- 验收：对称用例通过；索引可用。

## 阶段6｜报价（B6，3d）
- 任务：POST /api/offers；校验自报价/目标有效；详情聚合 offers。
- 验收：TC-OFFER-006；错误码一致。

## 阶段7｜留言（B7，2d）
- 任务：POST /api/comments、GET 列表；详情聚合 comments。
- 验收：TC-COMM-007；倒序分页。

## 阶段8｜信息管理（B8，3d）
- 任务：PATCH /api/items/{id} action=off/update（demands 同步）；软删。
- 验收：TC-MGMT-008；所有权校验。

## 阶段9｜审计与错误码统一（B9，2d）
- 任务：结构化日志、错误码表、追踪ID、关键操作审计。
- 验收：关键路径均有审计；错误码覆盖规范。

## 阶段10｜非功能基线（B10，2d）
- 任务：限流、安全头；备份/恢复演练（RPO≤24h/RTO≤4h）；性能压测脚本。
- 验收：P95 指标达标；备份恢复通过。

## 阶段11（可选）｜审核开关（1–2d）
- 任务：review.enabled 流程（pending→active）、admin 角色。
- 验收：状态迁移与权限正确。

## 阶段12｜交付与导出（0.5d）
- 任务：Mermaid PNG 已生成；pandoc 以模板导出 Docx；补交付清单。
- 验收：清单完整可验收。

---

## 并行建议（前端）
- 阶段2后对接登录/注册；阶段3–4对接发布/详情/搜索；阶段6–8对接报价/留言/管理。
- 契约先行：以 backend/api-spec.md 为契约；Mock→联调。

## 里程碑对齐
- M1 数据库可用（阶段1）
- M2 认证可用（阶段2）
- M3 商品主流程（阶段3–4）
- M4 互动闭环（阶段6–7）
- M5 验收（阶段8–10）

## 参考
- 架构/ER/时序：backend/assets/derived/*.mmd|*.png
- 接口规范：backend/api-spec.md
- DDL：database/db-schema.sql
- 计划与风险：backend/plan-backlog.md
